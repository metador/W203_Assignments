---
title: "Lab1"
author: "Melwin Poovakottu"
date: "Friday, January 20, 2017"
output: pdf_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
getwd()
library(car)
library(ggplot2)
library(dplyr)
load("ceo_w203.RData")
summary(CEO)
```




The market value has continous variable.
While running a summary command you see there is big difference in the mean(=3450) and Median(=1200). This means that the data is positively skewed to the right with a lot data points close to the median but a relatively high number of of outliers with higher market value.

When we see the boxplot it is clear that there are a many values which are above 1.5 times the 3 quatrile, causing the positive skew.


```{r}

summary(CEO$mktval)
ggplot(CEO,aes(mktval,color = as.factor(grad)))+ geom_histogram(binwidth = 1000,fill ="red",col="black")

ggplot(CEO,aes(y=mktval,x=1))+ geom_boxplot()
```



We see that there are some negative market value data points. These data points also have the profits as -1. 
This could potentially instances of missing data points and default value of -1 is recorded. So we will be considering them as

```{r}
CEO[CEO$mktval==-1,]

```

We can see a high correlation between market value and profits, which is expected for most companies.
Similary we see a good correlation between market value and salary.
Also we see that the if the CEO has a graduate degree he is more likely to get a better salary than without a graduate degree
On ploting the salary and profits against mktval, we see there are few data point that are outliers which are affecting the regression line thus 

```{r}
cor(CEO$mktval,CEO)

ggplot(CEO, aes(x = mktval, y = profits, color = as.factor(grad))) +geom_point() + stat_smooth(method = "lm")
ggplot(CEO, aes(x = mktval, y = salary, color = as.factor(grad))) +geom_point() + stat_smooth(method = "lm")

```




#Age

```{r}
summary(CEO$age)
hist(CEO$age, breaks = 8:40 *2.5)
boxplot(salary ~age,data=CEO)
ggplot(CEO,aes(age,color = as.factor(grad)))+ geom_histogram(binwidth = 2,fill ="red",col="black")

ggplot(CEO,aes(x=age,y=salary,color = as.factor(grad)))+ geom_point() 



salary_means= by(CEO$salary,CEO$age,mean)
plot(sort(unique(CEO$age)), salary_means)
abline(lm(salary_means~sort(unique(CEO$age))),col="red")
cor(salary_means,sort(unique(CEO$age)))

grouped = group_by(CEO, age)
mean_salary_age = summarise(grouped, mean_salary = mean(salary, na.rm = T))
ggplot(mean_salary_age,aes(x=age,y=mean_salary,color = as.factor(1)))+ geom_point()  + stat_smooth(method = "lm")
cor(mean_salary_age)

```

Narrowing age from 29  to 75 gives high co-relation

```{r}

narrowed_mean_salary_age=mean_salary_age[mean_salary_age$age<=75 & mean_salary_age$age>=29,]
ggplot(narrowed_mean_salary_age,aes(x=age,y=mean_salary,color = as.factor(1)))+ geom_point()  + stat_smooth(method = "lm")
cor(narrow_mean_salary_age)



```

```{r}
summary(CEO$mktval)
summary(CEO$profit)
CEO[CEO$mktval<=0 ,]
CEO[CEO$ceoten<=1,]
CEO[CEO$comten>=42,]
plot(CEO$mktval)


plot( CEO$salary[CEO$salary<=3000],log(CEO$mktval[CEO$salary<=3000]))
abline(lm(log(CEO$mktval[CEO$salary<=3000])~CEO$salary[CEO$salary<=3000]),col="red")
cor( CEO$salary[CEO$salary<=3000],log(CEO$mktval[CEO$salary<=3000]),use="complete.obs")

boxplot(mktval~salary,data = CEO)

```

```{r}
boxplot(CEO$profits)
summary(CEO$profits)
plot( subCeo$salary,subCeo$profits)
abline(lm(subCeo$profits~subCeo$salary),col="red")
cor(subCeo$salary,subCeo$profits)

plot(subCeo$profits,subCeo$salary)


scatterplotMatrix(~salary+age+college +grad+comten+ceoten+profits+mktval,data = CEO)
cor(CEO)
plot(CEO$age)
axis(100)
hist(CEO$profits, breaks= -568:2700 + 100)
boxplot(salary~profits, data=CEO[sub,])
plot(CEO$profits[CEO$profits<=800 & CEO$profits>=-00])
hist(CEO$age[CEO$age<=2500])
```

